{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yemengchen/Desktop/MERN_Practice/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/yemengchen/Desktop/MERN_Practice/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from'axios';import{setAlert}from'./alert';import{REGISTER_SUCCESS,REGISTER_FAIL,USER_LOADED,AUTH_ERROR,LOGIN_SUCCESS,LOGIN_FAIL,LOGOUT,CLEAR_PROFILE}from'./types';import setAuthToken from'../utils/setAuthToken';// Load User\nexport var loadUser=function loadUser(){var _ref;return function(_x){return(_ref=_ref||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(localStorage.token){setAuthToken(localStorage.token);}_context.prev=1;_context.next=4;return axios.get('/api/auth');case 4:res=_context.sent;dispatch({type:USER_LOADED,payload:res.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:AUTH_ERROR});case 11:case\"end\":return _context.stop();}},_callee,null,[[1,8]]);}))).apply(this,arguments);};};//Register User\nexport var register=function register(_ref2){var _ref3;var name=_ref2.name,email=_ref2.email,password=_ref2.password;return function(_x2){return(_ref3=_ref3||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var config,body,res,errors;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({name:name,email:email,password:password});_context2.prev=2;_context2.next=5;return axios.post('/api/users',body,config);case 5:res=_context2.sent;dispatch({type:REGISTER_SUCCESS,payload:res.data});dispatch(loadUser());_context2.next=15;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](2);errors=_context2.t0.response.data.errors;if(errors){errors.forEach(function(error){return dispatch(setAlert(error.msg,'danger'));});}dispatch({type:REGISTER_FAIL});case 15:case\"end\":return _context2.stop();}},_callee2,null,[[2,10]]);}))).apply(this,arguments);};};export var login=function login(_ref4){var _ref5;var email=_ref4.email,password=_ref4.password;return function(_x3){return(_ref5=_ref5||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var config,body,res,errors;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context3.prev=2;_context3.next=5;return axios.post('/api/auth',body,config);case 5:res=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(loadUser());_context3.next=15;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](2);errors=_context3.t0.response.data.errors;if(errors){errors.forEach(function(error){return dispatch(setAlert(error.msg,'danger'));});}dispatch({type:LOGIN_FAIL});case 15:case\"end\":return _context3.stop();}},_callee3,null,[[2,10]]);}))).apply(this,arguments);};};// LogOut\nexport var logout=function logout(){return function(dispatch){dispatch({type:CLEAR_PROFILE});dispatch({type:LOGOUT});};};","map":{"version":3,"names":["axios","setAlert","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","CLEAR_PROFILE","setAuthToken","loadUser","_ref","_x","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","res","wrap","_callee$","_context","prev","next","localStorage","token","get","sent","type","payload","data","t0","stop","apply","arguments","register","_ref2","_ref3","name","email","password","_x2","_callee2","config","body","errors","_callee2$","_context2","headers","JSON","stringify","post","response","forEach","error","msg","login","_ref4","_ref5","_x3","_callee3","_callee3$","_context3","logout"],"sources":["/Users/yemengchen/Desktop/MERN_Practice/client/src/actions/auth.js"],"sourcesContent":["import axios from 'axios';\nimport { setAlert } from './alert';\nimport {\n    REGISTER_SUCCESS,\n    REGISTER_FAIL,\n    USER_LOADED,\n    AUTH_ERROR,\n    LOGIN_SUCCESS,\n    LOGIN_FAIL,\n    LOGOUT,\n    CLEAR_PROFILE\n} from './types';\nimport setAuthToken from '../utils/setAuthToken';\n\n\n// Load User\nexport const loadUser = () => async dispatch => {\n    if (localStorage.token) {\n        setAuthToken(localStorage.token);\n    }\n    try {\n        const res = await axios.get('/api/auth');\n\n        dispatch({\n            type: USER_LOADED,\n            payload: res.data\n        });\n    } catch (err){\n        dispatch({\n            type: AUTH_ERROR\n        });\n    }\n\n}\n\n\n//Register User\n\nexport const register = ({ name, email, password }) => async dispatch =>{\n    const config ={\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n\n    const body = JSON.stringify({ name, email, password});\n    try {\n        const res = await axios.post('/api/users', body, config);\n\n        dispatch({  \n            type: REGISTER_SUCCESS,\n            payload: res.data\n        });\n        dispatch(loadUser());\n    }catch(err){\n        const errors = err.response.data.errors;\n\n        if (errors){\n            errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n        }\n        \n        dispatch({\n            type: REGISTER_FAIL\n        });\n\n    }\n};\n\n\nexport const login = ({ email, password }) => async dispatch =>{\n    const config ={\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n\n    const body = JSON.stringify({ email, password});\n    try {\n        const res = await axios.post('/api/auth', body, config);\n\n        dispatch({\n            type: LOGIN_SUCCESS,\n            payload: res.data\n        });\n\n        dispatch(loadUser());\n    }catch(err){\n        const errors = err.response.data.errors;\n\n        if (errors){\n            errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n        }\n        \n        dispatch({\n            type: LOGIN_FAIL\n        });\n\n    }\n};\n\n// LogOut\nexport const logout = () => dispatch => {\n    dispatch({ type: CLEAR_PROFILE});\n    dispatch({ type: LOGOUT});\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}